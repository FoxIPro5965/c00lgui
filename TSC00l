local runService = game:GetService("RunService")
local players = game:GetService("Players")
local localPlayer = players.LocalPlayer
local character = localPlayer.Character
local humanoid = character and character:WaitForChild("Humanoid")
local humanoidRootPart = character and character:WaitForChild("HumanoidRootPart")
local playerUserId = localPlayer.UserId
local playerName = localPlayer.Name

--

-- exploits
local function exploits()

    if workspace:GetAttribute("VIPServer") ~= tostring(playerUserId) then
        workspace:SetAttribute("VIPServer", tostring(playerUserId))
    end
    if workspace:GetAttribute("VIPServerOwner") ~= playerName then
        workspace:SetAttribute("VIPServerOwner", playerName)
    end
    --

    if localPlayer:GetAttribute("ExtraSlots") == nil then
        localPlayer:SetAttribute("ExtraSlots", false)
    end
    --
    if localPlayer:GetAttribute("EmoteSearchBar") == nil then
        localPlayer:SetAttribute("EmoteSearchBar", false)
    end
    --
    if workspace:GetAttribute("NoDashCooldown") == nil then
        workspace:SetAttribute("NoDashCooldown", false)
    end
    --
    if workspace:GetAttribute("NoFatigue") == nil then
        workspace:SetAttribute("NoFatigue", false)
    end

end
exploits()

-- 
local tspeed = 0.1
local tpwalking = false

--

--
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "TSC00l",
   Icon = "user",
   LoadingTitle = "c00lgui",
   LoadingSubtitle = "The Strongest Battleground",
   ShowText = "c00lgui",
   Theme = "Default",

   ToggleUIKeybind = "K",

   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,

   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "TSB-Script"
   },

   Discord = {
      Enabled = false, 
      Invite = "noinvitelink", 
      RememberJoins = true 
   },

   KeySystem = false, 
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true, 
      GrabKeyFromSite = false, 
      Key = {"Hello"} 
   }
})
--

-- as tabs- 
local mainTab = Window:CreateTab("Main", "user")
local teleportTab = Window:CreateTab("Teleport", "map")
--

localPlayer.CharacterAdded:Connect(function(char)
    character = char
    humanoid = character:WaitForChild("Humanoid")
    humanoidRootPart = character:WaitForChild("HumanoidRootPart")
end)

mainTab:CreateDivider()

mainTab:CreateToggle({
   Name = "Speed Boost",
   CurrentValue = false,
   Flag = "SpeedBoostToggle",
   Callback = function(Value)
       tpwalking = Value
   end,
})

mainTab:CreateSlider({
   Name = "Speed",
   Range = {0, 5},
   Increment = 0.1,
   Suffix = "*",
   CurrentValue = 0.1,
   Flag = "SpeedBoostSlider",
   Callback = function(Value)
       tspeed = Value
   end,
})

runService.Heartbeat:Connect(function()
    if tpwalking and character and humanoid then
        if humanoid.MoveDirection.Magnitude > 0 then
            if tspeed then
                 humanoidRootPart.CFrame = humanoidRootPart.CFrame + (humanoid.MoveDirection * tspeed)
            end
        end
    end
end)

mainTab:CreateToggle({
   Name = "Jump Boost",
   CurrentValue = false,
   Flag = "JumpBoostToggle",
   Callback = function(Value)
       humanoid.UseJumpPower = not Value
   end,
})

mainTab:CreateSlider({
   Name = "Jump",
   Range = {7.2, 500},
   Increment = 0.1,
   Suffix = "%",
   CurrentValue = 7.2,
   Flag = "JumpBoostSlider",
   Callback = function(Value)
       humanoid.JumpHeight = Value
   end,
})

mainTab:CreateDivider()

mainTab:CreateSlider({
   Name = "Gravity",
   Range = {0, 192.6},
   Increment = 0.1,
   Suffix = "%",
   CurrentValue = 192.6,
   Flag = "GravitySlider",
   Callback = function(Value)
       workspace.Gravity = Value
   end,
})

mainTab:CreateSlider({
   Name = "FOV",
   Range = {0, 120},
   Increment = 0.1,
   Suffix = "%",
   CurrentValue = 70,
   Flag = "FOVSlider",
   Callback = function(Value)
       workspace.CurrentCamera.FieldOfView = Value
   end,
})

mainTab:CreateDivider()

mainTab:CreateSection("Exploits")

mainTab:CreateToggle({
   Name = "No Dash Cooldown",
   CurrentValue = false,
   Flag = "noDashCooldownToggle",
   Callback = function(Value)
       workspace:SetAttribute("NoDashCooldown", Value)
   end,
})

mainTab:CreateToggle({
   Name = "No Fatigue",
   CurrentValue = false,
   Flag = "noFatigueToggle",
   Callback = function(Value)
       workspace:SetAttribute("NoFatigue", Value)
   end,
})

mainTab:CreateDivider()

mainTab:CreateToggle({
   Name = "Emotes Extra Slots",
   CurrentValue = false,
   Flag = "emotesExtraSlotsToggle",
   Callback = function(Value)
         localPlayer:SetAttribute("ExtraSlots", Value)
   end,
})

mainTab:CreateToggle({
   Name = "Emotes Search Bar",
   CurrentValue = false,
   Flag = "emotesSearchBarToggle",
   Callback = function(Value)
       localPlayer:SetAttribute("EmoteSearchBar", Value)
   end,
})

----------------------------------------------------------------------------------
-- tp tab

teleportTab:CreateSection("Teleports")

teleportTab:CreateButton({
    Name = "middle",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(148, 441, 27)
    end
})

teleportTab:CreateButton({
    Name = "Atomic Room",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(1079, 155, 23003)
    end
})

teleportTab:CreateButton({
    Name = "Death Counter Room",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(-92, 29, 20347)
    end
})

teleportTab:CreateButton({
    Name = "Baseplate",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(968, 20, 23088)
    end
})

teleportTab:CreateButton({
    Name = "Mountain 1",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(266, 699, 458)
    end
})

teleportTab:CreateButton({
    Name = "Mountain 2",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(551, 630, -265)
    end
})

teleportTab:CreateButton({
    Name = "Mountain 3",
    Callback = function()
        humanoidRootPart.CFrame = CFrame.new(-107, 642, -328)
    end
})
getgenv().SilentAimEnabled = false
getgenv().SilentAimConnection = nil
getgenv().SilentAimGui = nil

local function createSilentAimGUI()
    if getgenv().SilentAimGui then
        getgenv().SilentAimGui:Destroy()
        getgenv().SilentAimGui = nil
    end

    local gui = Instance.new("ScreenGui")
    gui.Name = "SilentAimGuiV3"
    gui.ResetOnSpawn = false
    gui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
    getgenv().SilentAimGui = gui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 50)
    frame.Position = UDim2.new(0.5, -90, 0.2, 0)
    frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Draggable = true
    frame.Parent = gui

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0,12)
    corner.Parent = frame

    local stroke = Instance.new("UIStroke")
    stroke.Thickness = 2
    stroke.Color = Color3.fromRGB(0,255,0)
    stroke.Parent = frame

    local toggleButton = Instance.new("TextButton")
    toggleButton.Size = UDim2.new(1, 0, 1, 0)
    toggleButton.BackgroundTransparency = 1
    toggleButton.TextScaled = true
    toggleButton.Font = Enum.Font.SourceSansBold
    toggleButton.Text = "Silent Aim : ON"
    toggleButton.TextColor3 = Color3.fromRGB(0,255,0)
    toggleButton.Parent = frame

    local function updateUI(enabled)
        if enabled then
            toggleButton.Text = "Silent Aim : ON"
            toggleButton.TextColor3 = Color3.fromRGB(0,255,0)
            stroke.Color = Color3.fromRGB(0,255,0)
        else
            toggleButton.Text = "Silent Aim : OFF"
            toggleButton.TextColor3 = Color3.fromRGB(120,120,120)
            stroke.Color = Color3.fromRGB(120,120,120)
        end
    end

    toggleButton.Activated:Connect(function()
        getgenv().SilentAimEnabled = not getgenv().SilentAimEnabled
        updateUI(getgenv().SilentAimEnabled)
    end)

    toggleButton.MouseEnter:Connect(function()
        frame.BackgroundColor3 = Color3.fromRGB(45,45,45)
    end)
    toggleButton.MouseLeave:Connect(function()
        frame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    end)
end

local function getClosestLiving()
    local character = game.Players.LocalPlayer.Character
    if not character then return nil end
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nil end

    local closest, dist = nil, math.huge
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Humanoid") and obj.Health > 0 then
            local targetChar = obj.Parent
            if game.Players:GetPlayerFromCharacter(targetChar) \~= game.Players.LocalPlayer then
                local targetHrp = targetChar:FindFirstChild("HumanoidRootPart")
                if targetHrp then
                    local d = (targetHrp.Position - hrp.Position).Magnitude
                    if d < dist then
                        dist = d
                        closest = targetChar
                    end
                end
            end
        end
    end
    return closest
end

aimTab:CreateToggle({
    Name = "Silent Aim GUI",
    CurrentValue = false,
    Flag = "SilentAimLoadToggle",
    Callback = function(Value)
        if Value then
            createSilentAimGUI()

            if getgenv().SilentAimConnection then
                getgenv().SilentAimConnection:Disconnect()
            end

            getgenv().SilentAimEnabled = true

            getgenv().SilentAimConnection = game:GetService("RunService").Heartbeat:Connect(function()
                if not getgenv().SilentAimEnabled then return end

                local character = game.Players.LocalPlayer.Character
                if not character then return end
                local hrp = character:FindFirstChild("HumanoidRootPart")
                if not hrp then return end

                local target = getClosestLiving()
                if target and target:FindFirstChild("HumanoidRootPart") then
                    local pos = target.HumanoidRootPart.Position
                    hrp.CFrame = CFrame.new(hrp.Position, Vector3.new(pos.X, hrp.Position.Y, pos.Z))
                end
            end)

        else
            getgenv().SilentAimEnabled = false

            if getgenv().SilentAimConnection then
                getgenv().SilentAimConnection:Disconnect()
                getgenv().SilentAimConnection = nil
            end

            if getgenv().SilentAimGui then
                getgenv().SilentAimGui:Destroy()
                getgenv().SilentAimGui = nil
            end
        end
    end
})
